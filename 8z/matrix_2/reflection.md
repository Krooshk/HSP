Сделал подобным образом. Только не вычислял для каждого символа сколько раз он встречается, а сразу вичислял эту разницу, можно назвать это неким баланс. 
