Не догадался заранее подсчитать сумму для каждой матрицы относительного верхнего левого угла. Сделал за O(N^4).
Для каждого размера шел таким образом: вправо до конца, на один шаг вниз, влево до начала, на один шаг вниз и так далее.
Для первой подматрицы сумма подсчитана. А далее выполняется только два расчета: для первой крайней полоски(ее вычтем) и для последней(новой полоски) которую добавим в новую сумму.
Таким образом первый внешний цикл равен n. Второй цикл равен n^2, хоть он и не вложенный но выполняет итераций (n - size + 1) * (n - size + 1).
Последний остается подсчет полосок, он равен 2n, "2" опускаем. В итоге сложность получается O(n^2) для подсчета полос.
Подсчет первой матрицы (n^2), но так внутри первого цикла дальше сложность (n^3), то (n^2) опускаем.
В итоге получается финальная сложность О(n^4).